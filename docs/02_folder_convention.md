# フォルダ構成ルール（第1・第2スクリーニング運用版）

## 目的
本プロジェクトの成果物が散逸しないよう、スクリーニング成果（第1・第2）を中心にフォルダ構成を規格化する。
当面はスクリプトを改修せず、フォルダ運用だけで整理する。
将来、一般配布（ユーザーフレンドリー化）に向けて、引数化・GUI化しやすい構造を前提とする。

※作業フォルダ構成の正は `docs/05_work_folder_structure.md` とし、本ドキュメントは第1/第2スクリーニング運用の補足に限定する。

## ルート構成（ETC2）
作業フォルダ構成の詳細は `docs/05_work_folder_structure.md` を正とする。

## 第1スクリーニング（00_共通データ/01_第１スクリーニング）
### 役割
元データを「トリップ単位ファイル」に分解する一次生成物。
容量が大きい。できる限り 00_共通データ/01_第１スクリーニング/ に集約し、案件側は参照でもよい。

### 推奨構成
必要に応じて YYYYMM 単位で整理し、`trips_raw/`（トリップCSV群）、`logs/`（実行ログ）、`meta/`（対象日リスト・総件数・メモ）を配置する。

## 第2スクリーニング（{PROJECT_ID}/20_第２スクリーニング）
### 役割
目的に応じて、必要なときに必要なものだけを抽出する。
現状スクリプト（20/21）は基本「OK（HIT）トリップのみ」を出力する想定。

### 命名規則（フォルダ名）
- _は1つで区切る
- 2nd_route/2nd_pointを必ず含める
- src1stラベルは使わない（冗長のため）
- 末尾に入力元の月YYYYMMを付ける（どの月の1stから抽出したかの識別）

ルート抽出：

```text
YYYYMMDD_HHMM_2nd_route_{ROUTE_NAME}_{YYYYMM}
```

交差点抽出：

```text
YYYYMMDD_HHMM_2nd_point_{CROSSSET_NAME}_{YYYYMM}
```

例：

```text
20260107_1042_2nd_route_Route01_202502
20260107_1110_2nd_point_Tsuyama-ST_202502
```

### 推奨構成（第2スクリーニング1単位）
第2スクリーニングの各フォルダは、必要に応じて次のサブフォルダを用意する。
- `00_input_prepared/`: 入力として固定したい生成物（参照含む）
- `10_output_ok/`: 第2スクリーニングの出力（OKトリップ）
- `99_meta/`: 任意：ログ・条件メモ

00_input_prepared に置くもの（例）
- src_1st_link：入力元1stフォルダへの参照（ショートカット/シンボリックリンク等）
- ルート抽出の場合：route_def/、trips_for_route/
- 交差点抽出の場合：cross_def/、trips_for_points/

10_output_ok に置くもの（例）
- 現状の第2スクリーニングスクリプトの出力（OKトリップCSV群）
- 交差点版は交差点名サブフォルダが増える場合がある（スクリプト仕様による）

99_meta（任意だが推奨）
- log.txt：実行ログ貼り付け
- params.txt：対象期間、対象曜日、入力元、メモ

### 運用メモ（最低限のルール）
- 第2スクリーニングは「必要時に必要分」抽出する前提。実行単位ごとに作業日（時刻）を付与する。
- 可能な限り入力はコピーではなく参照とし、容量爆発を防ぐ。
- 第2スクリーニングの成果は 10_output_ok/ に集約し、他の成果と混在させない。
- 全フォルダを事前に作成しない。作業して成果ができたフォルダのみ作成する。

### 将来（一般配布向け）に向けた前提
- 将来、引数化/GUI化を行う場合でも、入力=00_input_prepared、出力=10_output_okを固定できるため、共通関数でパスを組み立てやすい。
