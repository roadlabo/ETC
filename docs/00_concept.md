# 00_concept

ETC2.0 プローブデータを、行政 EBPM の説明責任に耐える形で段階的に扱うためのツールセットです。生データを一気に解釈するのではなく、番号付きのスクリプトで「前処理 → サンプリング → 第1/第2スクリーニング → 可視化・性能評価 → OD/経路分析」へと精度を積み上げます。

## 基本方針
- **src/ のファイル名が唯一の正**：docs は常にコードに追随させ、番号は処理順を示します。
- **PDFの分析フローを踏襲**：第1/第2スクリーニング、ビューア、設定ファイル作成、OD、経路分析という語彙を統一します。
- **推定であって結論ではない**：OD も経路も「材料」であり、個別車両の目的地断定には使いません。
- **再現性を優先**：入力の列位置、閾値、出力命名規則をすべて明示し、ログや中間生成物を残します。

## 番号体系の意味
- **01**: 生データ分割（ZIP ストリーミング、OPID 単位、時系列ソート）
- **05–12**: ビューアと設定ファイル作成（ルート定義、交差点定義、ゾーン作成）
- **20–21**: 第1/第2スクリーニングでトリップ抽出（ルート／交差点近傍）
- **30–32**: 性能評価とビューア（速度・通過性能の算出と可視化）
- **40–42**: OD 系（様式1-3参照 OD リスト生成、ヒートマップ、ゾーン別集計）
- **71**: 経路分析（方向別メッシュ集計、可視化）
- **map.html**: ルート可視化のサンプル出力（プレゼン用）

## できること / できないこと
- できること
  - ZIP 群から 2 次メッシュを跨いで網羅的に検索し、運行 ID ごとに分割
  - サンプルルートや交差点ポリゴンを GUI/ブラウザで作成し、閾値を明示した抽出
  - 様式1-2 から様式1-3参照 OD リスト → OD マトリクス → ヒートマップまで一貫生成
  - 500m–20m メッシュでの経路ヒートマップ・方向別集計
- できないこと（重要）
  - 個別車両の目的地特定や違反推定など、身元に紐づく結論を出すこと
  - 第1/第2スクリーニングの閾値を満たさないデータの外挿推論
  - スクリプト外の前処理（欠損補完、測位誤差補正）を自動保証すること

## データ利用上の前提
- 対象エリアを含む **2 次メッシュの全件を検索**し、運行 ID で時系列ソートした上で処理します。
- 期間・規模の例：11 か月 / 約 5TB / 12 府県規模を想定した設計。メモリ不足時はチャンク処理と外部ソートを利用してください。
- 解析結果は相対評価で提示し、政策判断は道路管理者の責任で行います。

## 参照先
- 処理フロー詳細: [docs/01_pipeline.md](./01_pipeline.md)
- 用語 FAQ: [docs/99_faq.md](./99_faq.md)
- 各スクリプトの実行手順: docs 配下の番号付きファイルを参照（src と同名）
