# 05_route_mapper_simple
## 目的（何をする）
任意のトリップ/ルート CSV を選択し、ブラウザで軌跡を可視化する。サンプルルートの妥当性や抽出結果の概形を素早く確認するためのビューア。
## 位置づけ（分析フロー上のどこ）
- **ビューア / 設定ファイル確認**フェーズ。
- 第1/第2スクリーニングで生成した CSV（様式1-2 相当）や `10_route_sampler.py` で作成したサンプルルートの品質確認に利用。
## 入力
- CSV（既定で `*.csv`。コマンド引数でパターン指定可）。
- 列前提（0 始まり）: 経度=15, 緯度=14, FLAG=12, TYPE=4, USE=5, GPS時刻=6, 速度=18。日本国内判定のため緯度/経度の範囲チェックを実施。
## 出力
- スクリプトと同階層に `map.html` を生成。初回のみブラウザを自動起動し、以降は同じタブで更新。
## 実行方法
- コマンド例: `python 05_route_mapper_simple.py` （起動後にフォルダ選択ダイアログ）。
- 任意のパターンを指定する場合: `python 05_route_mapper_simple.py "R7_*.csv"`。
- GUI でファイルを選択すると即座に描画し、S/G マーカーと速度ツールチップを表示。
## 判定ロジック（重要なものだけ）
- pandas で対象列を読み込み、緯度経度を NaN/範囲外で除外。
- FLAG=0/1/2 に応じて区切りを入れ、Folium でポリラインと通過点を描画。
- GPS 時刻と速度をツールチップに整形し、車種/用途のユニーク値を情報パネルに表示。
## できること / できないこと（行政向けの注意）
- できること: 抽出結果の空間的な妥当性チェック、サンプルルートの目視検証、座標範囲の異常検知。
- できないこと: 正式な性能評価や統計集計、測位誤差補正、FLAG 判定の再計算。可視化は確認用であり、政策判断には後段の集計結果を用いる。
## よくあるミス
- 列順を変えた CSV を読み込み、経度緯度が入れ替わる（範囲チェックで除外される）。
- ブラウザのポップアップブロックにより初回表示に失敗。
- 大量ファイルを入れたフォルダを指定し、リストアップに時間がかかる。
## 関連スクリプト
- 前段: [docs/10_route_sampler.md](./10_route_sampler.md)（生成したサンプルルートの確認）。
- 後段: なし（ビューア）。
- 兄弟ツール: [docs/06_route_mapper_kp.md](./06_route_mapper_kp.md)（KP ラベル付き版）。
- フロー全体: [docs/01_pipeline.md](./01_pipeline.md)
